<UserControl x:Class="AxialSqlTools.DatabaseScripterToolWindowControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignWidth="600"
             Name="MyToolWindow">
    <UserControl.Resources>
        <!-- Custom CheckBox style with explicit dark/light theme support -->
        <Style x:Key="ThemedCheckBox" TargetType="CheckBox">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid Background="Transparent">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- CheckBox border and checkmark -->
                            <Border x:Name="CheckBoxBorder"
                                    Grid.Column="0"
                                    Width="16"
                                    Height="16"
                                    BorderThickness="1"
                                    BorderBrush="White"
                                    Background="Transparent"
                                    Margin="0,0,6,0"
                                    VerticalAlignment="Center">
                                <Path x:Name="CheckMark"
                                      Data="M 0,4 L 4,8 L 10,0"
                                      Stroke="White"
                                      StrokeThickness="2"
                                      Visibility="Collapsed"
                                      Stretch="Uniform"
                                      Margin="2"/>
                            </Border>
                            
                            <!-- Content (label text) -->
                            <ContentPresenter x:Name="ContentPresenter"
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            TextElement.Foreground="White"
                                            Content="{TemplateBinding Content}"/>
                        </Grid>
                        
                        <ControlTemplate.Triggers>
                            <!-- Show checkmark when checked -->
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="CheckMark" Property="Visibility" Value="Visible"/>
                            </Trigger>
                            
                            <!-- Hover effect -->
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="CheckBoxBorder" Property="BorderBrush" Value="#E0E0E0"/>
                                <Setter TargetName="ContentPresenter" Property="TextElement.Foreground" Value="#E0E0E0"/>
                            </Trigger>
                            
                            <!-- Disabled state -->
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="CheckBoxBorder" Property="BorderBrush" Value="#606060"/>
                                <Setter TargetName="CheckBoxBorder" Property="Opacity" Value="0.4"/>
                                <Setter TargetName="CheckMark" Property="Stroke" Value="#606060"/>
                                <Setter TargetName="ContentPresenter" Property="TextElement.Foreground" Value="#606060"/>
                                <Setter TargetName="ContentPresenter" Property="Opacity" Value="0.4"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>
    
    <Grid Margin="0">
        <!-- Frame 1: Main Sync UI -->
        <Grid Name="MainFrame" Visibility="Visible">
            <StackPanel Orientation="Vertical" VerticalAlignment="Top" Margin="0">
                <StackPanel Orientation="Horizontal" Background="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}">
                    <TextBlock Margin="5" HorizontalAlignment="Center" VerticalAlignment="Top"
                               FontWeight="Bold" FontSize="18">
                        Sync to GitHub
                    </TextBlock>
                    <TextBlock Margin="10" HorizontalAlignment="left" >
                        <Run Text="Feature description in"/>
				        <Hyperlink
					        NavigateUri="https://github.com/Axial-SQL/AxialSqlTools/wiki/Sync-to-GitHub"
					        RequestNavigate="buttonWikiPage_Click">
				            <Run Text="Wiki"/>
                        </Hyperlink>
                    </TextBlock>
                </StackPanel>



                <StackPanel Orientation="Vertical" VerticalAlignment="Top" Margin="5">

                    <!-- Profiles -->
                    <GroupBox Margin="0,5">
                        <GroupBox.Header>
                            <TextBlock Text="Profiles" FontSize="14" FontWeight="Bold"/>
                        </GroupBox.Header>
                        <StackPanel Orientation="Horizontal" Margin="0,4">
                            <ComboBox Name="ProfilesComboBox"
                                  Width="300"
                                  ItemsSource="{Binding _profiles}"
                                  DisplayMemberPath="ProfileName"
                                  SelectionChanged="ProfilesComboBox_SelectionChanged"/>
                            <Button Content="+ Add New Profile" Width="140" Margin="8,0,0,0"
                                Click="AddNewProfileButton_Click"/>
                            <Button Content="Edit" Width="80" Margin="8,0,0,0"
                                Click="EditProfileButton_Click"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Repo Info -->
                    <GroupBox Margin="0,5">
                        <GroupBox.Header>
                            <TextBlock Text="Target Repo Info" FontSize="14" FontWeight="Bold"/>
                        </GroupBox.Header>
                        <StackPanel Orientation="Vertical" Margin="5">
                            <!-- Repo URL -->
                            <TextBlock Margin="5,2,0,0">
                                <Hyperlink Name="RepoUrlHyperlink" RequestNavigate="RepoUrlHyperlink_RequestNavigate">
                                    Repo: (none selected)
                                </Hyperlink>
                            </TextBlock>

                            <!-- Sync Options -->
                            <StackPanel Orientation="Vertical" Margin="0,5,0,0">
                                <TextBlock Name="RepoSyncOptionsTextBlock"
                                   Text="Sync options will appear here"
                                   FontStyle="Italic"/>
                            </StackPanel>
                            <StackPanel Orientation="Vertical" Margin="0,5,0,0">
                                <TextBlock Name="RepoSyncDbsTextBlock"
                                   Text="List of databases will appear here"
                                   FontStyle="Italic"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>

                    <!-- Commit Section -->
                    <GroupBox Margin="0,5">
                        <GroupBox.Header>
                            <TextBlock Text="Commit" FontSize="14" FontWeight="Bold"/>
                        </GroupBox.Header>
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,8">
                                <TextBlock Text="Commit Msg:" Width="80"/>
                                <TextBox Name="MessageTextBox" Width="300"
                                         Text="Add or update scripted objects"/>
                                <CheckBox Name="ConfirmBeforePushing"
                                          Content="Confirm before pushing"
                                          Margin="10,0,0,0"/>
                            </StackPanel>
                            <Button Name="RunButton"
                                    Content="Script And Commit"
                                    Width="160" Height="40"
                                    HorizontalAlignment="Left"
                                    Click="RunButton_Click"/>
                            <ProgressBar Name="OverallProgressBar"
                                         Height="16" Minimum="0" Maximum="100"
                                         Margin="0,8"/>
                            <ListBox Name="ProgressListBox" Height="200"/>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </StackPanel>
        </Grid>

        <!-- Frame 2: Profile Editor -->
        <Grid Name="ProfileEditorFrame" Visibility="Collapsed">
            <StackPanel Margin="10">
                <TextBlock Text="Edit Sync Profile" FontWeight="Bold" FontSize="16"/>
                <TextBox Name="ProfileNameTextBox" Margin="0,10,0,0" />

                <TextBlock Text="Repository Details:" Margin="0,10,0,0" FontWeight="SemiBold"/>

                <StackPanel Orientation="Vertical" Margin="0,5,0,0">
                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                        <TextBlock Text="Owner:" Width="80" VerticalAlignment="Center"/>
                        <TextBox Name="RepoOwnerTextBox" Width="250"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                        <TextBlock Text="Repo Name:" Width="80" VerticalAlignment="Center"/>
                        <TextBox Name="RepoNameTextBox" Width="250"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                        <TextBlock Text="Branch:" Width="80" VerticalAlignment="Center"/>
                        <TextBox Name="RepoBranchTextBox" Width="250"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                        <TextBlock Text="Token:" Width="80" VerticalAlignment="Center"/>
                        <PasswordBox Name="RepoTokenBox" Width="250"/>
                    </StackPanel>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                    <Button Content="Set Connection" Click="SetProfileServerConnection_Click"/>
                    <TextBlock Text="Connection Info:" Name="ProfileConnectionInfoTextBox"/>
                </StackPanel>

                <CheckBox Name="ExportServerParamsCheckBox" Content="Export SQL Server Configuration Values" Margin="0,10,0,0"/>
                <CheckBox Name="ExportJobsCheckBox" Content="Export SQL Server Agent Parameters - Jobs, Operators, Alerts" Margin="0,10,0,0"/>
                <CheckBox Name="ExportLoginsCheckBox" Content="Export Logins and Permissions" Margin="0,10,0,0"/>

                <StackPanel Orientation="Vertical" Margin="0,5,0,0">
                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                        <TextBlock Text="Databases:" Width="80" VerticalAlignment="Center"/>
                        <TextBox Name="ListOfDatabasesTextBox" Width="400"/>
                    </StackPanel>
                </StackPanel>
                <StackPanel Orientation="Vertical" Margin="0,5,0,0">
                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                        <TextBlock Text="Use Ola Hallengren keywords such as ALL_DATABASES, USER_DATABASES, etc."/>
                    </StackPanel>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Margin="0,15,0,0">
                    <Button Content="Save Profile" Click="SaveProfile_Click"/>
                    <Button Content="Cancel" Click="CancelProfileEdit_Click" Margin="10,0,0,0"/>
                    <Button Content="Delete Profile" Click="DeleteProfile_Click" Margin="10,0,0,0"
                    Background="#FFD9534F" Foreground="White"/>
                </StackPanel>
            </StackPanel>
        </Grid>

    </Grid>
</UserControl>

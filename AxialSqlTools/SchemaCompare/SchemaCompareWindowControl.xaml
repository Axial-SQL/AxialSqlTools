<UserControl x:Class="AxialSqlTools.SchemaCompareWindowControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" MinWidth="900" MinHeight="600">
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Border Grid.Row="0" BorderBrush="#FFDDDDDD" BorderThickness="0,0,0,1" Padding="8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <StackPanel Margin="0,0,16,0" Orientation="Vertical">
                    <TextBlock Text="Source" FontWeight="Bold" Margin="0,0,0,4" />
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                        <Button Content="Use Selected" Width="120" Command="{Binding PickSourceCommand}" />
                        <Button Content="Clear" Width="70" Margin="8,0,0,0" Command="{Binding ClearSourceCommand}" />
                    </StackPanel>
                    <TextBlock Text="{Binding SourceDisplay}" TextTrimming="CharacterEllipsis" />
                </StackPanel>
                <StackPanel Grid.Column="1" Margin="0,0,16,0" Orientation="Vertical">
                    <TextBlock Text="Target" FontWeight="Bold" Margin="0,0,0,4" />
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                        <Button Content="Use Selected" Width="120" Command="{Binding PickTargetCommand}" />
                        <Button Content="Clear" Width="70" Margin="8,0,0,0" Command="{Binding ClearTargetCommand}" />
                    </StackPanel>
                    <TextBlock Text="{Binding TargetDisplay}" TextTrimming="CharacterEllipsis" />
                </StackPanel>
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Bottom">
                    <Button Content="Swap" Width="80" Margin="0,0,8,0" Command="{Binding SwapConnectionsCommand}" />
                    <Button Content="Compare" Width="120" Command="{Binding CompareCommand}" />
                </StackPanel>
            </Grid>
        </Border>

        <Grid Grid.Row="1" Margin="8">
            <Grid.RowDefinitions>
                <RowDefinition Height="2*" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <DataGrid Grid.Row="0" ItemsSource="{Binding Differences}" AutoGenerateColumns="False" IsReadOnly="True"
                      CanUserAddRows="False" HeadersVisibility="Column" Margin="0,0,0,8">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="2*" />
                    <DataGridTextColumn Header="Action" Binding="{Binding Action}" Width="*" />
                    <DataGridTextColumn Header="Difference Type" Binding="{Binding DifferenceType}" Width="*" />
                    <DataGridTextColumn Header="Source Object" Binding="{Binding SourceObject}" Width="2*" />
                    <DataGridTextColumn Header="Target Object" Binding="{Binding TargetObject}" Width="2*" />
                </DataGrid.Columns>
            </DataGrid>

            <GroupBox Grid.Row="1" Header="Deployment Script">
                <TextBox Text="{Binding DeploymentScript, Mode=OneWay}" FontFamily="Consolas" FontSize="12" AcceptsReturn="True"
                         TextWrapping="NoWrap" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto"
                         IsReadOnly="True" />
            </GroupBox>
        </Grid>

        <Border Grid.Row="2" BorderBrush="#FFDDDDDD" BorderThickness="1,1,1,0" Padding="8">
            <DockPanel>
                <TextBlock Text="{Binding Status}" VerticalAlignment="Center" />
                <ProgressBar Width="180" Height="16" Margin="12,0,0,0" IsIndeterminate="True"
                             Visibility="{Binding IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}" />
            </DockPanel>
        </Border>
    </Grid>
</UserControl>
